# 2.1 UserDaoTest 다시 보기

## 2.1.1 테스트의 유용성

- 내가 예상하고 의도했던 대로 코드가 정확히 동작하는지 확인하는 과정
- 테스트가 성공하면 모든 결함이 제거되었다는 의미

## 2.1.2 UserDaoTest의 특징

### 웹을 통한 DAO 테스트 방법의 문제점

- 웹 화면을 통해 값을 입력하고 기능을 수행하고 결과를 확인하는 방법이 가장 흔하다.
- 위 방법은 DAO에 대한 테스트로서는 단점이 너무 많다. DAO뿐만 아니라 서비스, 컨트롤러, 뷰 등 모든 레이어 기능을 만들고 나서 테스트가 가능하기 때문이다. 또한 테스트 중 문제가 생기더라도 범위가 광범위하여 원인을 알아내기 힘들다.

### 작은 단위의 테스트

- 테스트는 가능한 작은 단위로 쪼개어 집중해서 실행해야 한다. → “관심사의 분리”라는 원리가 여기에도 적용된다.
- 단위 테스트 = 작은 단위의 코드에 대해 테스트를 수행하는 것
- 여기서 단위는 충분히 하나의 관심에 집중하여 효율적으로 테스트할 만한 범위라고 정한다.
- DB 사용 여부에 따라 단위인지 아닌지 판단하기도 한다. → DB가 사용되면 단위 테스트가 아니라고도 할 수 있다는 뜻이다. 통제할 수 없는 외부의 리소스에 의존하면 단위 테스트가 아니라고 보는 것이다.
- 물론 통합적으로도 잘 수행하는지 확인하기 위해 긴 테스트가 필요하기도 하다. 이때도 단위 테스트를 미리 했다면 테스트 실패 원인을 찾기 더 쉬울 것이다.

### 자동수행 테스트 코드

- 테스트는 자동으로 수행되도록 코드로 만들어지는 것이 중요하다. 자주 반복할 수 있기 때문이다.
- 클래스 안에 테스트 코드를 구성하는 것보다는 별도로 테스트용 클래스를 만드는 것이 낫다.

### 지속적인 개선과 점진적인 개발을 위한 테스트

- 작은 단계를 거치는 동안 테스트를 하나하나 다 수행하고 점차 코드를 변경해가야 한다. 그래야 전체적으로 코드를 개선하는 작업에 속도가 더 붙고 쉬워진다. 테스트 또한 점차 기능을 추가해나가며 점진적인 개발을 해나간다.

## 2.1.3 UserDaoTest의 문제점

1. 수동 확인 작업의 번거로움
    - 콘솔에 나온 값을 보고 등록과 조회가 성공적으로 진행되었는지 사람이 직접 확인해야 한다.
2. 실행 작업의 번거로움
    - main() 메소드를 여러 번 수행하고 기록하고 종합해야 하기 때문에 번거롭다.\

# 2.2 UserDaoTest 개선

## 2.2.1 테스트 검증의 자동화

- “add()에 전달한 User 오브젝트에 담긴 사용자 정보 = get()을 통해 다시 DB에서 가져온 User 오브젝트 정보” 인지 확인해야 한다.
- 테스트 에러 : 테스트가 진행되는 동안에 에러가 발생하여 실패하는 경우
    - 콘솔에 에러 메세지와 긴 호출 스택 정보가 출력되어 쉽게 알 수 있다.
- 테스트 실패 : 테스트 작업 중에 에러가 발생하진 않았지만 그 결과가 기대한 것과 다르게 나오는 경우
    - 별도의 확인 작업과 그 결과가 있어야 알 수 있다.
- if-else문을 통해 정보들이 같은지 확인하여 테스트가 성공 여부를 콘솔에 출력할 수 있다. → 결과 검증까지 테스트를 자동화 했다.

## 2.2.2 테스트의 효율적인 수행과 결과 관리

### JUnit 테스트로 전환

- 자바로 단위 테스트를 만들 때 유용하게 사용할 수 있는 프레임워크
- 프레임워크의 기본 동작 원리가 IoC이기 때문에 main() 메소드와 오브젝트를 만들어 실행시키는 코드가 필요 없다.
- 라이브러리 추가가 필요하다.

### 테스트 메소드 전환

- 테스트가 main() 메소드로 만들어졌다는 것으 ㄴ제어권을 직접 갖는다는 의미이다.
- 따라서 main() 메소드에 있던 테스트 코드를 일반 메소드로 옮겨야 한다.
- JUnit 프레임워크가 요구하는 조건
    1. 메소드가 public으로 선언되어야 한다.
    2. 메소드에 @Test 어노테이션이 붙어야 한다.

### 검증 코드 전환

- if-else문을 asserThat() 이라는 static 메소드를 사용해 전환해줄 수 있다.
- assertThat() 메소드는 첫번째 파라미터의 값을 뒤에 나오는 matcher라고 불리는 조건으로 비교하여 일치하면 패스하고, 아니면 테스트가 실패하도록 만들어준다.
- is()는 matcher의 일종으로 equals()로 비교해주는 기능을 가진다.
- “테스트 성공” 이라는 메세지를 굳이 출력하지 않아도 테스트 결과를 JUnit이 다양하게 알려준다.

### JUnit 테스트 실행

- 어디선가 한 번은 JUnit 프레임워크를 시작시켜 주어야 한다.
- 어디에든 main() 메소드를 하나 추가하고 그 안에 JUnitCore 클래스의 main 메소드를 호출하는 코드를 넣어주면 된다.
